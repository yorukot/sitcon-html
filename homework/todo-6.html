<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>我的代辦事項</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Huninn&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Huninn", sans-serif;
        background-color: #17171c;
        color: #eee;
        font-size: 16px;
      }

      .main-title {
        color: #eee;
        text-align: center;
        font-weight: bold;
        font-size: 36px;
        background-color: #22222a;
        border: 2px solid #4ecdc4;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0px;
      }

      .section-title {
        color: #4ecdc4;
        font-weight: bold;
        font-size: 24px;
      }

      .form-label {
        color: #eee;
        font-weight: bold;
        font-size: 16px;
      }

      .form-input {
        font-family: "Huninn", sans-serif;
        font-size: 16px;
        color: #ffffff;
        background-color: #22222a;
        border: 1px solid #4ecdc4;
        border-radius: 8px;
        padding: 10px;
        margin: 5px 0;
        display: block;
      }

      .btn-primary {
        background-color: #e17055;
        color: #fff;
        font-family: "Huninn", sans-serif;
        font-size: 18px;
        font-weight: bold;
        border: none;
        border-radius: 12px;
        padding: 12px 24px;
        margin-top: 10px;
        cursor: pointer;
      }

      .todo-item {
        color: #ffeaa7;
        font-weight: bold;
        font-size: 20px;
        padding-bottom: 10px;
      }

      .completed-item {
        color: #00b894;
        font-size: 20px;
        margin-bottom: 10px;
      }

      .divider {
        background-color: #4ecdc4;
        height: 3px;
        border-radius: 5px;
        margin: 30px 0;
      }

      .card {
        background-color: #22222a;
        border: 1px solid #4ecdc4;
        border-radius: 10px;
        padding: 20px;
      }
    </style>
  </head>
  <body>
    <h1 class="main-title">我的待辦清單</h1>

    <hr class="divider">

    <h3 class="section-title">新增待辦事項</h3>
    <label class="form-label">新的待辦事項：</label>
    <input type="text" id="todoInput" class="form-input" placeholder="輸入新的待辦事項" />

    <br>
    <label class="form-label">狀態：</label>

    <select class="form-input">
      <option value="true">已完成</option>
      <option value="false">未完成</option>
    </select>

    <br>
    <label class="form-label">備註：</label>
    <textarea rows="1" class="form-input" placeholder="輸入詳細備註"></textarea>
    <br>
    <button type="button" id="addBtn" class="btn-primary" onclick="createTodo()">新增</button>

    <hr class="divider">

    <h3 class="section-title">待完成事項</h3>
    <div class="card">
      <ol id="todoList">
        <li class="todo-item">
          <label> <input type="checkbox" /> 完成 HTML 作業 </label>
        </li>
        <li class="todo-item">
          <label> <input type="checkbox" /> 買晚餐<br />記得買飲料 </label>
        </li>
        <li class="todo-item">
          <label>
            <input type="checkbox" />
            準備明天的報告<br />整理資料<br />製作投影片
          </label>
        </li>
      </ol>
    </div>

    <hr class="divider">

    <h3 class="section-title">已完成事項</h3>
    <div class="card">
      <ul id="completedList">
      </ul>
    </div>
  </body>
    <script>
    const API_URL = "http://localhost:8000";

    // 載入待辦事項
    async function loadTodos() {
      const response = await fetch(`${API_URL}/todos`);
      const data = await response.json();
      let todoHtml = "";

      data.forEach((todo) => {
          todoHtml += `
          <li class="todo-item">
            <label>
              <input type="checkbox" onchange="completeTodo(${todo.id}, '${todo.title}')" />
              ${todo.title}
            </label>
            <button onclick="deleteTodo(${todo.id})">刪除</button>
          </li>`;
      });

      document.getElementById('todoList').innerHTML = todoHtml;
    }

    // 新增待辦事項
    async function createTodo() {
      const input = document.getElementById('todoInput');
      const title = input.value.trim();

      if (title) {
        await fetch(`${API_URL}/todo`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title: title, completed: false })
        });

        input.value = '';
        loadTodos();
      }
    }

    // 頁面載入時自動載入待辦事項
    loadTodos();

    // 完成待辦事項
    async function completeTodo(id, title) {
      await fetch(`${API_URL}/todo/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title: title, completed: true })
      });
      loadTodos();
    }

    // 刪除待辦事項
    async function deleteTodo(id) {
      await fetch(`${API_URL}/todo/${id}`, {
        method: 'DELETE'
      });
      loadTodos();
    }
  </script>
</html>
